asyncapi: '2.0.0'
info:
  title: components
  version: '1.0.0'

components:
#  messageBindings:
#  serverBindings:
#  operationBindings:
#  channelBindings:

  messages:
    someMessage:
      headers:
        $ref: '#/components/schemas/someSchema'
      correlationId:
        $ref: '#/components/correlationIds/someId'
      payload:
        type: string
      schemaFormat: application/schema+json;version=draft-07
      contentType: application/json
      name: lightMeasured
      title: Light measured
      summary: Inform about environmental lighting conditions of a particular streetlight.

  schemas:
    someSchema:
      type: object
      properties:
        a:
          type: number
          minimum: 0
          exclusiveMaximum: 100

  parameters:
    userId:
      description: id of the user
      location: $message.payload#/user/id
      schema:
        type: string

  correlationIds:
    someId:
      description: Default Correlation ID
      location: $message.header#/correlationId

channels:
  smartylighting/streetlights/1/0/event/lighting/measured:
    parameters:
      someId:
        $ref: '#/components/parameters/userId'
    publish:
      message:
        $ref: '#/components/messages/someMessage'